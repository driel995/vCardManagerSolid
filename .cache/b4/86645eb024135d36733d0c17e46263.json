{"id":"tyEP","dependencies":[{"name":"C:\\Users\\39351\\Progetti\\SolidProject\\node_modules\\@inrupt\\solid-client-authn-browser\\dist\\login\\oidc\\incomingRedirectHandler\\AuthCodeRedirectHandler.js.map","includedInParent":true,"mtime":1671123281671},{"name":"C:\\Users\\39351\\Progetti\\SolidProject\\node_modules\\@inrupt\\solid-client-authn-browser\\src\\login\\oidc\\incomingRedirectHandler\\AuthCodeRedirectHandler.ts","includedInParent":true,"mtime":1671123281745},{"name":"C:\\Users\\39351\\Progetti\\SolidProject\\package.json","includedInParent":true,"mtime":1671127455006},{"name":"C:\\Users\\39351\\Progetti\\SolidProject\\node_modules\\@inrupt\\solid-client-authn-browser\\package.json","includedInParent":true,"mtime":1671123281699},{"name":"@inrupt/solid-client-authn-core","loc":{"line":4,"column":42,"index":164},"parent":"C:\\Users\\39351\\Progetti\\SolidProject\\node_modules\\@inrupt\\solid-client-authn-browser\\dist\\login\\oidc\\incomingRedirectHandler\\AuthCodeRedirectHandler.js","resolved":"C:\\Users\\39351\\Progetti\\SolidProject\\node_modules\\@inrupt\\solid-client-authn-core\\dist\\index.mjs"},{"name":"@inrupt/oidc-client-ext","loc":{"line":5,"column":34,"index":235},"parent":"C:\\Users\\39351\\Progetti\\SolidProject\\node_modules\\@inrupt\\solid-client-authn-browser\\dist\\login\\oidc\\incomingRedirectHandler\\AuthCodeRedirectHandler.js","resolved":"C:\\Users\\39351\\Progetti\\SolidProject\\node_modules\\@inrupt\\oidc-client-ext\\dist\\index.es.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.AuthCodeRedirectHandler=void 0;const e=require(\"@inrupt/solid-client-authn-core\"),t=require(\"@inrupt/oidc-client-ext\");class r{constructor(e,t,r,s,i){this.storageUtility=e,this.sessionInfoManager=t,this.issuerConfigFetcher=r,this.clientRegistrar=s,this.tokerRefresher=i}async canHandle(e){try{const r=new URL(e);return null!==r.searchParams.get(\"code\")&&null!==r.searchParams.get(\"state\")}catch(t){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${t}`)}}async handle(r,s){if(!(await this.canHandle(r)))throw new Error(`AuthCodeRedirectHandler cannot handle [${r}]: it is missing one of [code, state].`);const i=new URL(r),o=i.searchParams.get(\"state\"),n=await this.storageUtility.getForUser(o,\"sessionId\",{errorIfNull:!0}),{issuerConfig:a,codeVerifier:c,redirectUrl:d,dpop:h}=await(0,e.loadOidcContextFromStorage)(n,this.storageUtility,this.issuerConfigFetcher);if(void 0===c)throw new Error(`The code verifier for session ${n} is missing from storage.`);if(void 0===d)throw new Error(`The redirect URL for session ${n} is missing from storage.`);const l=await this.clientRegistrar.getClient({sessionId:n},a);let g;const u=Date.now();let f;h?(g=await(0,t.getDpopToken)(a,l,{grantType:\"authorization_code\",code:i.searchParams.get(\"code\"),codeVerifier:c,redirectUrl:d}),window.localStorage.removeItem(`oidc.${o}`)):g=await(0,t.getBearerToken)(i.toString()),void 0!==g.refreshToken&&(f={sessionId:n,refreshToken:g.refreshToken,tokenRefresher:this.tokerRefresher});const w=await(0,e.buildAuthenticatedFetch)(fetch,g.accessToken,{dpopKey:g.dpopKey,refreshOptions:f,eventEmitter:s,expiresIn:g.expiresIn});await this.storageUtility.setForUser(n,{webId:g.webId,isLoggedIn:\"true\"},{secure:!0}),i.searchParams.delete(\"code\"),await this.storageUtility.setForUser(n,{redirectUrl:i.toString()},{secure:!1});const p=await this.sessionInfoManager.get(n);if(!p)throw new Error(`Could not retrieve session: [${n}].`);return Object.assign(p,{fetch:w,expirationDate:\"number\"==typeof g.expiresIn?u+1e3*g.expiresIn:null})}}exports.AuthCodeRedirectHandler=r;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":0}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":13}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":20}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":35}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":43}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":56}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":57}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":64}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":68}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":76}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":105}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":30,"column":0},"generated":{"line":1,"column":107}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":30,"column":0},"generated":{"line":1,"column":113}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":30,"column":0},"generated":{"line":1,"column":115}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":30,"column":0},"generated":{"line":1,"column":123}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":43,"column":0},"generated":{"line":1,"column":158}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":43,"column":0},"generated":{"line":1,"column":160}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":43,"column":0},"generated":{"line":1,"column":168}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":195}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":13},"generated":{"line":1,"column":201}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":54,"column":2},"generated":{"line":1,"column":203}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":55,"column":12},"generated":{"line":1,"column":215}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":56,"column":12},"generated":{"line":1,"column":217}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":57,"column":12},"generated":{"line":1,"column":219}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":58,"column":12},"generated":{"line":1,"column":221}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":59,"column":12},"generated":{"line":1,"column":223}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":55,"column":12},"generated":{"line":1,"column":226}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":55,"column":12},"generated":{"line":1,"column":231}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":55,"column":12},"generated":{"line":1,"column":246}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":56,"column":12},"generated":{"line":1,"column":248}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":56,"column":12},"generated":{"line":1,"column":253}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":56,"column":12},"generated":{"line":1,"column":272}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":57,"column":12},"generated":{"line":1,"column":274}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":57,"column":12},"generated":{"line":1,"column":279}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":57,"column":12},"generated":{"line":1,"column":299}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":58,"column":12},"generated":{"line":1,"column":301}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":58,"column":12},"generated":{"line":1,"column":306}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":58,"column":12},"generated":{"line":1,"column":322}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":59,"column":12},"generated":{"line":1,"column":324}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":59,"column":12},"generated":{"line":1,"column":329}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":59,"column":12},"generated":{"line":1,"column":344}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":62,"column":2},"generated":{"line":1,"column":346}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":62,"column":18},"generated":{"line":1,"column":362}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":63,"column":4},"generated":{"line":1,"column":365}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":64,"column":6},"generated":{"line":1,"column":369}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":64,"column":12},"generated":{"line":1,"column":375}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":64,"column":20},"generated":{"line":1,"column":377}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":64,"column":24},"generated":{"line":1,"column":381}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":64,"column":28},"generated":{"line":1,"column":385}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":65,"column":6},"generated":{"line":1,"column":388}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":66,"column":43},"generated":{"line":1,"column":395}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":66,"column":8},"generated":{"line":1,"column":402}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":66,"column":14},"generated":{"line":1,"column":404}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":66,"column":27},"generated":{"line":1,"column":417}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":66,"column":31},"generated":{"line":1,"column":421}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":67,"column":44},"generated":{"line":1,"column":430}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":67,"column":8},"generated":{"line":1,"column":437}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":67,"column":14},"generated":{"line":1,"column":439}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":67,"column":27},"generated":{"line":1,"column":452}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":67,"column":31},"generated":{"line":1,"column":456}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":69,"column":6},"generated":{"line":1,"column":465}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":69,"column":13},"generated":{"line":1,"column":471}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":70,"column":6},"generated":{"line":1,"column":474}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":70,"column":12},"generated":{"line":1,"column":480}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":70,"column":16},"generated":{"line":1,"column":484}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":71,"column":12},"generated":{"line":1,"column":494}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":71,"column":86},"generated":{"line":1,"column":558}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":76,"column":2},"generated":{"line":1,"column":564}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":77,"column":4},"generated":{"line":1,"column":577}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":78,"column":4},"generated":{"line":1,"column":579}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":80,"column":4},"generated":{"line":1,"column":582}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":80,"column":16},"generated":{"line":1,"column":593}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":80,"column":21},"generated":{"line":1,"column":598}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":80,"column":31},"generated":{"line":1,"column":608}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":81,"column":6},"generated":{"line":1,"column":612}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":81,"column":12},"generated":{"line":1,"column":618}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":81,"column":16},"generated":{"line":1,"column":622}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":82,"column":50},"generated":{"line":1,"column":670}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":86,"column":4},"generated":{"line":1,"column":713}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":86,"column":10},"generated":{"line":1,"column":719}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":86,"column":16},"generated":{"line":1,"column":721}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":86,"column":20},"generated":{"line":1,"column":725}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":86,"column":24},"generated":{"line":1,"column":729}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":87,"column":10},"generated":{"line":1,"column":732}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":87,"column":23},"generated":{"line":1,"column":734}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":87,"column":27},"generated":{"line":1,"column":736}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":87,"column":40},"generated":{"line":1,"column":749}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":87,"column":44},"generated":{"line":1,"column":753}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":89,"column":10},"generated":{"line":1,"column":762}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":89,"column":35},"generated":{"line":1,"column":770}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":89,"column":40},"generated":{"line":1,"column":775}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":89,"column":55},"generated":{"line":1,"column":790}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":90,"column":6},"generated":{"line":1,"column":801}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":91,"column":6},"generated":{"line":1,"column":803}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":92,"column":6},"generated":{"line":1,"column":815}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":93,"column":8},"generated":{"line":1,"column":816}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":93,"column":21},"generated":{"line":1,"column":829}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":97,"column":10},"generated":{"line":1,"column":834}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":98,"column":6},"generated":{"line":1,"column":847}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":98,"column":18},"generated":{"line":1,"column":849}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":99,"column":6},"generated":{"line":1,"column":862}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":100,"column":6},"generated":{"line":1,"column":864}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":100,"column":19},"generated":{"line":1,"column":876}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":101,"column":6},"generated":{"line":1,"column":878}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":101,"column":12},"generated":{"line":1,"column":883}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":102,"column":14},"generated":{"line":1,"column":892}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":102,"column":14},"generated":{"line":1,"column":894}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":102,"column":14},"generated":{"line":1,"column":896}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":103,"column":6},"generated":{"line":1,"column":924}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":104,"column":6},"generated":{"line":1,"column":926}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":104,"column":11},"generated":{"line":1,"column":931}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":105,"column":6},"generated":{"line":1,"column":946}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":105,"column":11},"generated":{"line":1,"column":951}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":108,"column":4},"generated":{"line":1,"column":972}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":108,"column":25},"generated":{"line":1,"column":980}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":108,"column":8},"generated":{"line":1,"column":984}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":109,"column":6},"generated":{"line":1,"column":986}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":109,"column":12},"generated":{"line":1,"column":992}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":109,"column":16},"generated":{"line":1,"column":996}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":110,"column":41},"generated":{"line":1,"column":1035}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":114,"column":4},"generated":{"line":1,"column":1065}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":114,"column":30},"generated":{"line":1,"column":1073}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":114,"column":8},"generated":{"line":1,"column":1077}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":115,"column":6},"generated":{"line":1,"column":1079}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":115,"column":12},"generated":{"line":1,"column":1085}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":115,"column":16},"generated":{"line":1,"column":1089}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":116,"column":40},"generated":{"line":1,"column":1127}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":120,"column":4},"generated":{"line":1,"column":1157}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":120,"column":10},"generated":{"line":1,"column":1163}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":120,"column":34},"generated":{"line":1,"column":1171}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":120,"column":39},"generated":{"line":1,"column":1176}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":120,"column":55},"generated":{"line":1,"column":1192}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":121,"column":6},"generated":{"line":1,"column":1202}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":121,"column":8},"generated":{"line":1,"column":1203}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":121,"column":19},"generated":{"line":1,"column":1213}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":122,"column":6},"generated":{"line":1,"column":1216}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":125,"column":4},"generated":{"line":1,"column":1219}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":125,"column":8},"generated":{"line":1,"column":1223}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":126,"column":4},"generated":{"line":1,"column":1225}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":126,"column":10},"generated":{"line":1,"column":1231}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":126,"column":27},"generated":{"line":1,"column":1233}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":126,"column":32},"generated":{"line":1,"column":1238}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":146,"column":4},"generated":{"line":1,"column":1244}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":146,"column":8},"generated":{"line":1,"column":1248}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":128,"column":8},"generated":{"line":1,"column":1250}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":129,"column":6},"generated":{"line":1,"column":1253}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":129,"column":21},"generated":{"line":1,"column":1261}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":129,"column":21},"generated":{"line":1,"column":1263}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":129,"column":21},"generated":{"line":1,"column":1265}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":129,"column":34},"generated":{"line":1,"column":1279}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":129,"column":48},"generated":{"line":1,"column":1281}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":129,"column":56},"generated":{"line":1,"column":1283}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":130,"column":8},"generated":{"line":1,"column":1284}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":130,"column":19},"generated":{"line":1,"column":1294}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":133,"column":8},"generated":{"line":1,"column":1315}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":133,"column":14},"generated":{"line":1,"column":1320}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":133,"column":18},"generated":{"line":1,"column":1322}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":133,"column":31},"generated":{"line":1,"column":1335}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":133,"column":35},"generated":{"line":1,"column":1339}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":134,"column":8},"generated":{"line":1,"column":1347}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":134,"column":8},"generated":{"line":1,"column":1360}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":135,"column":8},"generated":{"line":1,"column":1362}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":135,"column":21},"generated":{"line":1,"column":1374}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":141,"column":6},"generated":{"line":1,"column":1378}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":141,"column":13},"generated":{"line":1,"column":1385}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":141,"column":26},"generated":{"line":1,"column":1398}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":141,"column":45},"generated":{"line":1,"column":1417}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":143,"column":6},"generated":{"line":1,"column":1423}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":143,"column":21},"generated":{"line":1,"column":1431}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":143,"column":21},"generated":{"line":1,"column":1433}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":143,"column":21},"generated":{"line":1,"column":1435}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":143,"column":36},"generated":{"line":1,"column":1451}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":143,"column":40},"generated":{"line":1,"column":1453}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":147,"column":32},"generated":{"line":1,"column":1470}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":147,"column":8},"generated":{"line":1,"column":1474}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":147,"column":15},"generated":{"line":1,"column":1476}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":148,"column":6},"generated":{"line":1,"column":1491}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":148,"column":23},"generated":{"line":1,"column":1493}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":149,"column":8},"generated":{"line":1,"column":1494}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":149,"column":19},"generated":{"line":1,"column":1504}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":150,"column":8},"generated":{"line":1,"column":1506}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":150,"column":22},"generated":{"line":1,"column":1519}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":150,"column":29},"generated":{"line":1,"column":1521}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":151,"column":8},"generated":{"line":1,"column":1534}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":151,"column":24},"generated":{"line":1,"column":1549}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":151,"column":29},"generated":{"line":1,"column":1554}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":155,"column":4},"generated":{"line":1,"column":1571}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":155,"column":10},"generated":{"line":1,"column":1577}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":155,"column":28},"generated":{"line":1,"column":1585}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":155,"column":28},"generated":{"line":1,"column":1587}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":155,"column":28},"generated":{"line":1,"column":1589}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":155,"column":52},"generated":{"line":1,"column":1614}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":155,"column":59},"generated":{"line":1,"column":1620}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":155,"column":66},"generated":{"line":1,"column":1622}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":155,"column":79},"generated":{"line":1,"column":1634}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":156,"column":6},"generated":{"line":1,"column":1635}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":156,"column":15},"generated":{"line":1,"column":1643}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":156,"column":22},"generated":{"line":1,"column":1645}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":157,"column":6},"generated":{"line":1,"column":1653}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":157,"column":6},"generated":{"line":1,"column":1668}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":158,"column":6},"generated":{"line":1,"column":1670}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":158,"column":6},"generated":{"line":1,"column":1683}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":159,"column":6},"generated":{"line":1,"column":1685}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":159,"column":17},"generated":{"line":1,"column":1695}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":159,"column":24},"generated":{"line":1,"column":1697}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":162,"column":10},"generated":{"line":1,"column":1715}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":162,"column":15},"generated":{"line":1,"column":1720}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":162,"column":30},"generated":{"line":1,"column":1735}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":163,"column":6},"generated":{"line":1,"column":1746}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":164,"column":6},"generated":{"line":1,"column":1748}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":165,"column":8},"generated":{"line":1,"column":1749}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":165,"column":15},"generated":{"line":1,"column":1755}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":165,"column":22},"generated":{"line":1,"column":1757}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":166,"column":8},"generated":{"line":1,"column":1763}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":166,"column":20},"generated":{"line":1,"column":1774}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":168,"column":6},"generated":{"line":1,"column":1782}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":168,"column":8},"generated":{"line":1,"column":1783}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":168,"column":16},"generated":{"line":1,"column":1791}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":173,"column":4},"generated":{"line":1,"column":1795}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":173,"column":8},"generated":{"line":1,"column":1797}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":173,"column":21},"generated":{"line":1,"column":1810}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":173,"column":28},"generated":{"line":1,"column":1817}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":174,"column":10},"generated":{"line":1,"column":1831}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":174,"column":15},"generated":{"line":1,"column":1836}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":174,"column":30},"generated":{"line":1,"column":1851}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":175,"column":6},"generated":{"line":1,"column":1862}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":176,"column":6},"generated":{"line":1,"column":1864}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":177,"column":8},"generated":{"line":1,"column":1865}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":177,"column":21},"generated":{"line":1,"column":1877}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":177,"column":25},"generated":{"line":1,"column":1879}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":179,"column":6},"generated":{"line":1,"column":1891}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":180,"column":8},"generated":{"line":1,"column":1892}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":180,"column":16},"generated":{"line":1,"column":1900}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":184,"column":4},"generated":{"line":1,"column":1904}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":184,"column":10},"generated":{"line":1,"column":1910}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":184,"column":30},"generated":{"line":1,"column":1918}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":184,"column":35},"generated":{"line":1,"column":1923}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":184,"column":54},"generated":{"line":1,"column":1942}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":184,"column":58},"generated":{"line":1,"column":1946}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":185,"column":4},"generated":{"line":1,"column":1949}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":185,"column":9},"generated":{"line":1,"column":1953}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":186,"column":6},"generated":{"line":1,"column":1955}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":186,"column":12},"generated":{"line":1,"column":1961}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":186,"column":16},"generated":{"line":1,"column":1965}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":186,"column":54},"generated":{"line":1,"column":2003}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":189,"column":4},"generated":{"line":1,"column":2010}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":189,"column":11},"generated":{"line":1,"column":2017}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":189,"column":18},"generated":{"line":1,"column":2024}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":189,"column":25},"generated":{"line":1,"column":2031}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":189,"column":38},"generated":{"line":1,"column":2033}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":190,"column":6},"generated":{"line":1,"column":2034}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":190,"column":13},"generated":{"line":1,"column":2040}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":191,"column":6},"generated":{"line":1,"column":2042}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":192,"column":36},"generated":{"line":1,"column":2057}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":192,"column":15},"generated":{"line":1,"column":2074}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":192,"column":22},"generated":{"line":1,"column":2076}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":193,"column":12},"generated":{"line":1,"column":2086}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":193,"column":48},"generated":{"line":1,"column":2088}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":193,"column":29},"generated":{"line":1,"column":2092}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":193,"column":36},"generated":{"line":1,"column":2094}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":194,"column":12},"generated":{"line":1,"column":2104}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":2112}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":2120}},{"source":"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts","name":null,"original":{"line":53,"column":0},"generated":{"line":1,"column":2144}}],"sources":{"../../../../src/login/oidc/incomingRedirectHandler/AuthCodeRedirectHandler.ts":"/*\r\n * Copyright 2022 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n\r\n/**\r\n * @hidden\r\n * @packageDocumentation\r\n */\r\n// FIXME: The following doesn't work in the browser, it results in all the fetches\r\n// being unauthenticated. This should be looked into when migrating to universal-fetch.\r\n// import { fetch } from \"cross-fetch\";\r\n\r\nimport {\r\n  buildAuthenticatedFetch,\r\n  IClient,\r\n  IClientRegistrar,\r\n  IIssuerConfigFetcher,\r\n  IIncomingRedirectHandler,\r\n  ISessionInfo,\r\n  ISessionInfoManager,\r\n  IStorageUtility,\r\n  ITokenRefresher,\r\n  loadOidcContextFromStorage,\r\n  RefreshOptions,\r\n} from \"@inrupt/solid-client-authn-core\";\r\nimport {\r\n  getDpopToken,\r\n  getBearerToken,\r\n  CodeExchangeResult,\r\n} from \"@inrupt/oidc-client-ext\";\r\nimport { EventEmitter } from \"events\";\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport class AuthCodeRedirectHandler implements IIncomingRedirectHandler {\r\n  constructor(\r\n    private storageUtility: IStorageUtility,\r\n    private sessionInfoManager: ISessionInfoManager,\r\n    private issuerConfigFetcher: IIssuerConfigFetcher,\r\n    private clientRegistrar: IClientRegistrar,\r\n    private tokerRefresher: ITokenRefresher\r\n  ) {}\r\n\r\n  async canHandle(redirectUrl: string): Promise<boolean> {\r\n    try {\r\n      const myUrl = new URL(redirectUrl);\r\n      return (\r\n        myUrl.searchParams.get(\"code\") !== null &&\r\n        myUrl.searchParams.get(\"state\") !== null\r\n      );\r\n    } catch (e) {\r\n      throw new Error(\r\n        `[${redirectUrl}] is not a valid URL, and cannot be used as a redirect URL: ${e}`\r\n      );\r\n    }\r\n  }\r\n\r\n  async handle(\r\n    redirectUrl: string,\r\n    eventEmitter?: EventEmitter\r\n  ): Promise<ISessionInfo & { fetch: typeof fetch }> {\r\n    if (!(await this.canHandle(redirectUrl))) {\r\n      throw new Error(\r\n        `AuthCodeRedirectHandler cannot handle [${redirectUrl}]: it is missing one of [code, state].`\r\n      );\r\n    }\r\n\r\n    const url = new URL(redirectUrl);\r\n    const oauthState = url.searchParams.get(\"state\") as string;\r\n\r\n    const storedSessionId = (await this.storageUtility.getForUser(\r\n      oauthState,\r\n      \"sessionId\",\r\n      {\r\n        errorIfNull: true,\r\n      }\r\n    )) as string;\r\n\r\n    const {\r\n      issuerConfig,\r\n      codeVerifier,\r\n      redirectUrl: storedRedirectIri,\r\n      dpop: isDpop,\r\n    } = await loadOidcContextFromStorage(\r\n      storedSessionId,\r\n      this.storageUtility,\r\n      this.issuerConfigFetcher\r\n    );\r\n\r\n    if (codeVerifier === undefined) {\r\n      throw new Error(\r\n        `The code verifier for session ${storedSessionId} is missing from storage.`\r\n      );\r\n    }\r\n\r\n    if (storedRedirectIri === undefined) {\r\n      throw new Error(\r\n        `The redirect URL for session ${storedSessionId} is missing from storage.`\r\n      );\r\n    }\r\n\r\n    const client: IClient = await this.clientRegistrar.getClient(\r\n      { sessionId: storedSessionId },\r\n      issuerConfig\r\n    );\r\n\r\n    let tokens: CodeExchangeResult;\r\n    const tokenCreatedAt = Date.now();\r\n\r\n    if (isDpop) {\r\n      tokens = await getDpopToken(issuerConfig, client, {\r\n        grantType: \"authorization_code\",\r\n        // We rely on our 'canHandle' function checking that the OAuth 'code'\r\n        // parameter is present in our query string.\r\n        code: url.searchParams.get(\"code\") as string,\r\n        codeVerifier,\r\n        redirectUrl: storedRedirectIri,\r\n      });\r\n\r\n      // Delete oidc-client-specific session information from storage. This is\r\n      // done automatically when retrieving a bearer token, but since the DPoP\r\n      // binding uses our custom code, this needs to be done manually.\r\n      window.localStorage.removeItem(`oidc.${oauthState}`);\r\n    } else {\r\n      tokens = await getBearerToken(url.toString());\r\n    }\r\n\r\n    let refreshOptions: RefreshOptions | undefined;\r\n    if (tokens.refreshToken !== undefined) {\r\n      refreshOptions = {\r\n        sessionId: storedSessionId,\r\n        refreshToken: tokens.refreshToken,\r\n        tokenRefresher: this.tokerRefresher,\r\n      };\r\n    }\r\n\r\n    const authFetch = await buildAuthenticatedFetch(fetch, tokens.accessToken, {\r\n      dpopKey: tokens.dpopKey,\r\n      refreshOptions,\r\n      eventEmitter,\r\n      expiresIn: tokens.expiresIn,\r\n    });\r\n\r\n    await this.storageUtility.setForUser(\r\n      storedSessionId,\r\n      {\r\n        webId: tokens.webId,\r\n        isLoggedIn: \"true\",\r\n      },\r\n      { secure: true }\r\n    );\r\n    // Clear the code query param from the redirect URL before storing it, but\r\n    // preserve any state that my have been provided by the client and returned\r\n    // by the IdP.\r\n    url.searchParams.delete(\"code\");\r\n    await this.storageUtility.setForUser(\r\n      storedSessionId,\r\n      {\r\n        redirectUrl: url.toString(),\r\n      },\r\n      {\r\n        secure: false,\r\n      }\r\n    );\r\n\r\n    const sessionInfo = await this.sessionInfoManager.get(storedSessionId);\r\n    if (!sessionInfo) {\r\n      throw new Error(`Could not retrieve session: [${storedSessionId}].`);\r\n    }\r\n\r\n    return Object.assign(sessionInfo, {\r\n      fetch: authFetch,\r\n      expirationDate:\r\n        typeof tokens.expiresIn === \"number\"\r\n          ? tokenCreatedAt + tokens.expiresIn * 1000\r\n          : null,\r\n    });\r\n  }\r\n}\r\n"},"lineCount":null}},"error":null,"hash":"0d8168a57f511a364398164f86504337","cacheData":{"env":{}}}